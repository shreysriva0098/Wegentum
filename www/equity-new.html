<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, minimal-ui, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="#3a57c4">
    <title>Wegentum Sight</title>
    <link rel="stylesheet" href="assets/css/framework7.ios.min.css">
    <link rel="stylesheet" href="assets/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/style.css">
	<link href="https://fonts.googleapis.com/css?family=Roboto+Slab:100,300,400,700|Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i" rel="stylesheet">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
	<style>
		.loader {
    position: fixed;
    left: 0px;
    top: 0px;
    width: 100%;
    height: 100%;
    z-index: 9999;
    background: url('https://www.gte.travel/images/upload//Loading/Preloader_2.gif?r=13/09/2017') 50% 50% no-repeat rgb(249,249,249);
    opacity: .8;
}
	</style>
</head>
<body>
<div class="loader"></div>
    <div id="app">
        
        <div class="panel panel-left panel-reveal">
            <div class="block">
                <div class="side-menu" id="sidebar-menu">
                    <ul>
                        <li>
                            <a class="panel-close" id="dashboard"><span><i class="fa fa-tachometer" aria-hidden="true"></i>Dashboard</span></a>
                        </li>
						<li class="submenu">
                            <a href="#" id="equity"><span><i class="fa fa-line-chart" aria-hidden="true"></i>Equities</span> </a>
                        </li>
                        <li>
                            <a class="panel-close" id="mf"><span><i class="fa fa-pie-chart" aria-hidden="true"></i>Mutual Funds</span></a>
                        </li>
                        <li>
                            <a class="panel-close" id="insurance" href=""><span><i class="fa fa-bar-chart" aria-hidden="true"></i>Insurance</span>
                            </a>
                        </li>
                        <li>
                            <a class="panel-close" id="fd"><span><i class="fa fa-magnet" aria-hidden="true"></i>Fixed Income Product</span>
                            </a>
                        </li>
							<li class="submenu">
                            <a id="financial-planning"><span><i class="fa fa-money" aria-hidden="true"></i>Financial Planning</span> </a>
                        </li>
						<li class="submenu">
                            <a id="wealth-management"><span><i class="fa fa-home" aria-hidden="true"></i>Wealth Management</span> </a>
                        </li>
						<li class="submenu">
                            <a id="itr"><span><i class="fa fa-file" aria-hidden="true"></i>ITR</span> </a>
                        </li>
						<li class="submenu">
                            <a id="sip"><span><i class="fa fa-calculator" aria-hidden="true"></i>SIP calculator</span> <!----></a>
                        </li>
						<li class="submenu">
                            <a href="#" id="profile"><span><i class="fa fa-user" aria-hidden="true"></i>Profile</span> <!----></a>
                        </li>
						<li class="submenu">
                            <a id="disclaimer"><span><i class="fa fa-info" aria-hidden="true"></i>Disclaimer</span> </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="view view-main view-init" data-url="/">
            <div class="page" data-name="index">
                <div class="navbar two-action no-hairline">
                    <div class="navbar-inner">
                        <div class="left">
                            <a href="#" class="link icon-only panel-open" data-panel="left"><i class="fa fa-bars">&nbsp;</i></a>
                        </div>
                        <div class="sliding title">Equity</div>
                        <div class="right">
                            <a id="notification" class="link icon-only"><i class="fa fa-bell">&nbsp;</i></a>
                            <a href="#" data-popover=".main-menu" class="link icon-only popover-open"><i class="fa fa-ellipsis-v">&nbsp;</i></a>
                        </div>
                    </div>
                </div>
                <div class="popover main-menu">
                    <div class="popover-angle"></div>
                    <div class="popover-inner">
                        <div class="list">
                           <ul>
                               <li><a href="#" id="name" class="list-button item-link popover-close">Name</a></li>
							   <li><a href="#" id="email" class="list-button item-link popover-close">Email</a></li>
							   <li><a href="#" id="mobile" class="list-button item-link popover-close">Mobile</a></li>
							   <li><a href="#" id="password_change" class="list-button item-link popover-close">Password Change</a></li>
							   <li><a href="#" id="logout" class="list-button item-link popover-close">Logout</a></li>
							   <li><a href="#" id="support" class="list-button item-link popover-close">Support</a></li>
							   <li><a href="#" id="query" class="list-button item-link popover-close">Query</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
				
                <div class="page-content inn-page">
				 <div class="block">
                      <div class="list no-hairlines media-list inv-list">
						<ul class="l-bg">
							<li class="swipeout">
								<a href="#." class="item-link item-content swipeout-content">
									<div class="item-inner">
										<div class="item-title-row">
											<div class="item-title md">Equity Value</div>
											<div class="float-right item-title md" id="Equity_Value"></div>
										</div>
									</div>
								</a>
							</li>
						</ul>
					<div class="mr20"></div>
					<ul class="l-bg">
						<li class="">	
                    <div class="toolbar tabbar toolbar-border">
					<div class="toolbar-inner">
							<a href="#tradesheet" class="tab-link tab-link-active">Trade Log</a>
							<a href="#holding" class="tab-link ">Holding</a>
						</div>
					</div>
                    
					<div class="tabs">
					<div class="tab tab-active" id="tradesheet">
					<ul class="no-bg">
					<li class="inn-list" id="equity_values">
						
						</li>
						</ul>
					</div>
					
					<div class="tab" id="holding">
					<ul class="no-bg">
					<li class="inn-list">
						<table class="responstable" id="trade_holding">
								  <tr>
									<th>Script</th>
									<th>Quantity</th>
									<th>Sector</th>
									<th>CMP</th>
									<th>Value</th>
								  </tr>
								</table>
								
							</li></ul>
								 <div class="actions">
						<div class="table2">
							<div class="plan">
							<div class="header" style="width:90%;"><span class="text float-left">Total no of Stock</span><span class="text float-right" id="Total_no_of_stock"></span></div><br>
							<div class="header" style="width:90%;"><span class="text float-left">Total Value</span><span class="text float-right" id="Total_value"></span></div>
							<!-- <div class="header"><span class="text float-left">Total no of Stock</span><span class="text float-right">2200</span></div>
							<div class="header"><span class="text float-left">Total no of Stock</span><span class="text float-right">2200</span></div> -->
							<div class="clear"></div>
							</div>
						</div>
					</div>
								
					 </div>

					</div>
                   </li>
				   </ul>
				   </div>
				 </div>	
                </div>
            </div>
        </div>
    </div>
	
    <script type="text/javascript" src="assets/js/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="assets/js/framework7.min.js"></script>
    <script type="text/javascript" src="assets/js/app.js"></script>
	<script src="assets/js/api_conf.js"></script>
	<script type="text/javascript" charset="utf-8" src="cordova.js"></script>
	<script type="text/javascript" charset="utf-8" src="js/notification.js"></script>
	<script type="text/javascript" charset="utf-8" src="js/index.js"></script>
	<script>
	$(document).ready(function(){
		$("#name").html(localStorage.getItem("txt_name"));
		$("#email").html(localStorage.getItem("txt_email"));
		$("#mobile").html(+localStorage.getItem("txt_phone"));
		$("#support").click(function(){
			window.open('tel:07522898884');
		});
		$("#dashboard").click(function(){
            window.location.href='dashboard.html';
        });
        $("#logout").click(function(){
            window.location.href='logout.html';
        });
        
        $("#notification").click(function(){
            window.location.href='notification.html';
        });
        
        $("#profile").click(function(){
            window.location.href='profile.html';
        });
        
        $("#equity").click(function(){
            window.location.href='equity-new.html';
        });
        
        $("#dashboard").click(function(){
            window.location.href='dashboard.html';
        });
        
        $("#insurance").click(function(){
            window.location.href='insurance.html';
        });
			
		$("#wealth-management").click(function(){
            window.location.href='wealth-management.html';
        });
        
		$("#itr").click(function(){
            window.location.href='itr.html';
        });
		
		$("#fd").click(function(){
            window.location.href='fixed-deposit.html';
        });
		
		$("#mf").click(function(){
            alert('Feature is under Construction');
        });
		
		$("#financial-planning").click(function(){
            window.location.href='financial-planning.html';
        });
		
        $("#password_change").click(function(){
            window.location.href='change_existing_password.html';
        });
		
		$("#disclaimer").click(function(){
            window.location.href='disclaimer.html';
        });
		
		$("#query").click(function(){
            window.location.href='query.html';
        });
		
		$("#sip").click(function(){
            window.location.href='sip.html';
        });
	});
	</script>
		<script>
			  var auth_key=localStorage.getItem("txt_auth_key");
			  var client_id=localStorage.getItem("int_unique_id");
			  $.ajax({
			  type: "POST",
			  url: apiUrl+"Apis/getEquityTradeSheet",
			  data: 
			  {
				'auth_key':auth_key,
				'client_id':client_id
			  },
              success:function(data)
              {
				$(".loader").fadeOut("slow");
				var obj2=JSON.parse(data);
				if(obj2.data.trade_sheet!=undefined)
				{
				console.log(obj2.data.trade_sheet);
				$("#Equity_Value").html(obj2.data.equity_val);
				
					for (i=0;i<obj2.data.trade_sheet.length;i++) 
					{  
						if(obj2.data.trade_sheet[i].book_profit>0 && obj2.data.trade_sheet[i].book_loss==0)
						{
							var pl=obj2.data.trade_sheet[i].book_profit;
							var classs='green';
						}
						else if(obj2.data.trade_sheet[i].book_profit==0 && obj2.data.trade_sheet[i].book_loss<0)
						{
							var pl=obj2.data.trade_sheet[i].book_loss;
							var classs="red";
						}
						else if(obj2.data.trade_sheet[i].book_profit==0 && obj2.data.trade_sheet[i].book_loss==0)
						{
							var pl=0;
							var classs="";
						}
						
						if(obj2.data.trade_sheet[i].NP>0 && obj2.data.trade_sheet[i].NL==0)
						{
							var npl=obj2.data.trade_sheet[i].NP;
							var npl_classs="green";
						}
						
						else if(obj2.data.trade_sheet[i].NP==0 && obj2.data.trade_sheet[i].NL<0)
						{
							var npl=obj2.data.trade_sheet[i].NP;
							var npl_classs="green";
						}
						
						else if(obj2.data.trade_sheet[i].NP==0 && obj2.data.trade_sheet[i].NL==0)
						{
							var npl=0;
							var npl_classs="";
						}
					
					
						var life = $('<div class="log-pan" >'
							+'<div class="blpan">'
								+'<div class="item-title small bl">'+obj2.data.trade_sheet[i].script+'</div>'
							+'</div>'
							+'<div class="brpan">'
								+'<div class="block-small">'
									+'<div class="cont">'
										+'<span>Buy Qty <em>'+obj2.data.trade_sheet[i].buy_qty+'</em></span>'
										+'<span>Buy Price <em>'+obj2.data.trade_sheet[i].buy_price+'</em></span>'
										+'<span>Buy Value <em>'+obj2.data.trade_sheet[i].buy_val+'</em></span>'
									+'</div>'
									+'<div class="cont">'
										+'<span>Sell Qty <em>'+obj2.data.trade_sheet[i].sell_qty+'</em></span>'
										+'<span>Sell Price <em>'+obj2.data.trade_sheet[i].sell_price+'</em></span>'
										+'<span>Sell Value <em>'+obj2.data.trade_sheet[i].sell_val+'</em></span>'
									+'</div>'
								+'</div>'
								+'<div class="clear"></div>'
							+'</div>'
							+'<div class="clear"></div>'
								+'<div class="block-small lres">'
									+'<div class="cont col4">'
										+'<span>Net Qty <em>'+obj2.data.trade_sheet[i].net_qty+'</em></span>'
										+'<span>Net Value <em>'+obj2.data.trade_sheet[i].net_val+'</em></span>'
										+'<span class="'+classs+'">P/L~ <em>'+pl+'%'+'</em></span>'
										+'<span class="'+npl_classs+'">Not P/L~ <em>'+npl+'%'+'</em></span>'
									+'</div>'
								+'</div>'
								
								+'<div class="clear"></div>'
								+'<div class="seperator1"></div>'
								
						+'</div>');
						 $('#equity_values').append(life);
					}
				}
				else
				{
						var life = $('<li><div class="brpan" style="width:100%;">'
								+'<div class="block-small" >'
									+'<div class="cont" >NO RECORD FOUND</div>'
								+'</div>'
							+'</div></li>');
						$('#equity_values').append(life);
				}
              },
			   error: function(result) {
					$(".loader").fadeOut("slow");
                    console.log("Some Error Occured");
                  }
			  });

			  
			$.ajax({
			  type: "POST",
			  url: apiUrl+"Apis/getEquityTradeHolding",
			  data: 
			  {
				'auth_key':auth_key,
				'client_id':client_id
			  },
              success:function(data)
              {
				var obj2=JSON.parse(data);
				//$("#Total_no_of_stock").html(obj2.data.tot_hold);
				//$("#Total_value").html(obj2.data.tot_val);

				if(obj2.data.holdings.length!=0)
				{
					var total_stock=0;
					var total_val=0;
					for (i=0;i<obj2.data.holdings.length;i++) 
					{  		
							var life = $('<tr>'
									+'<td>'+obj2.data.holdings[i].script+'</td>'
									+'<td>'+obj2.data.holdings[i].qty+'</td>'
									+'<td>'+obj2.data.holdings[i].sector+'</td>'
									+'<td>'+obj2.data.holdings[i].cmp+'</td>'
									+'<td>'+obj2.data.holdings[i].val+'</td>'
								  +'</tr>');
						 $('#trade_holding').append(life);
						  total_stock+=parseInt(obj2.data.holdings[i].qty);
						  total_val+=parseFloat(obj2.data.holdings[i].val);
					}
						$("#Total_no_of_stock").html(total_stock);
						$("#Total_value").html(total_val);
				}
				else
				{
						var life = $('<tr>'
									+'<td colspan="2">NO RECORD FOUND</td>'
								  +'</tr>');
						$('#trade_holding').append(life);
				}
              },
			   error: function(result) {
                    console.log("Some Error Occured");
                  }
			  });
			  
        </script>
</body>

</html>